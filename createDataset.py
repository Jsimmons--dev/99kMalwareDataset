from __future__ import print_function
import csv
import numpy as np
import sys
import math

fileprefix = '../beh2/'
nbins = 16

def binArray(array):
	newArray = np.zeros(nbins)
	for i, value in enumerate(array):
		bindex = int(nbins * (float(i) / len(array)))
		newArray[bindex] += value
	return newArray


def binBeh(beh):
	return np.apply_along_axis(binArray, 1, beh)

with open('99kDatasetNames.csv') as f:
	csv = csv.reader(f)
	for hash in csv:
		array  = binBeh(np.load(fileprefix + hash[0])).flatten()
		for i, value in enumerate(array):
			sys.stdout.write(str(int(value)) + ',')
		print(hash[1])
