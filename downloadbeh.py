import boto3
from multiprocessing.dummy import Pool
import csv
s3 = boto3.resource('s3')
bucket = s3.Bucket('c2020-byte-entropy-histograms')

pool = Pool(40)

hashes = []
#balancedLabels created with balancedHashList.py
with open('./balancedLabels.csv') as f:
	csvIn = csv.reader(f)
	for line in csvIn:
		hashes.append(line[0].rstrip())
print hashes

def downloadFile(hash):
	try:
		bucket.download_file(hash, './behDir/' + hash)
	except:
		pass

pool.map(downloadFile, hashes)

pool.close()
pool.join()
